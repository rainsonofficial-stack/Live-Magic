<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Magic Portal</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    overflow-y: hidden;
    background: black;
    color: white;
    height: 100%;
    font-family: "Poppins", sans-serif;
  }
  #passwordScreen, #imageContainer {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
  }
  #passwordScreen {
    background: radial-gradient(circle at center, #000 60%, #111 100%);
    text-align: center;
  }
  #hat {
    font-size: 60px;
    margin-bottom: 20px;
  }
  input[type="text"] {
    font-size: 18px;
    padding: 10px;
    border-radius: 8px;
    border: none;
    text-align: center;
    outline: none;
    margin-top: 10px;
  }
  button {
    margin-top: 10px;
    font-size: 18px;
    padding: 8px 20px;
    border-radius: 8px;
    border: none;
    background: #222;
    color: white;
    cursor: pointer;
  }
  button:hover {
    background: #333;
  }
  #msg {
    color: #f55;
    margin-top: 10px;
  }
  #imageContainer {
    display: none;
    flex-direction: column;
    overflow-y: scroll;
    scrollbar-width: none;
  }
  #imageContainer img {
    width: 100%;
    height: auto;
    display: block;
  }
  #overlay {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    z-index: 99;
    background: transparent;
  }
</style>
</head>
<body>

<div id="passwordScreen">
  <div id="hat">ðŸŽ©</div>
  <h2>Say the Magic Word</h2>
  <input id="magicWord" type="text" placeholder="Enter the word..." />
  <button onclick="checkMagic()">Enter</button>
  <p id="msg"></p>
</div>

<div id="imageContainer">
  <img src="https://picsum.photos/1080/1920?random=1" />
  <img src="https://picsum.photos/1080/1920?random=2" />
  <img src="https://picsum.photos/1080/1920?random=3" />
  <img src="https://picsum.photos/1080/1920?random=4" />
  <img src="https://picsum.photos/1080/1920?random=5" />
  <img src="https://picsum.photos/1080/1920?random=6" />
  <div id="overlay"></div>
</div>

<script>
const MAGIC_WORD = "MagicRain";
const endpoint = "https://script.google.com/macros/s/AKfycbxPIzP6Fx1JkXEdJlzp4f0St7rJcsvaK_fTSXBeVpLND8A2JJq5F6oeqS4IO0JQH3pl/exec";

let inputCode = "";
const MAX_INPUTS = 3;
let touchStartX = 0, touchStartY = 0;

// Unlock sequence
function checkMagic() {
  const val = document.getElementById("magicWord").value.trim();
  if (val === MAGIC_WORD) {
    document.getElementById("passwordScreen").style.display = "none";
    document.getElementById("imageContainer").style.display = "flex";
    document.body.style.overflowY = "scroll";
  } else {
    document.getElementById("msg").textContent = "Thatâ€™s not quite magical enough.";
  }
}

// Convert coordinates to 3Ã—3 grid number
function getGridNumber(x, y, width, height) {
  const col = Math.floor((x / width) * 3);
  const row = Math.floor((y / height) * 3);
  return row * 3 + col + 1;
}

// Send secret code to Google Script
function sendCode() {
  fetch(endpoint, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ user: "pots", code: inputCode })
  })
  .then(r => r.text())
  .catch(() => {});
}

// Track first touch position
document.addEventListener("touchstart", e => {
  const t = e.touches[0];
  touchStartX = t.clientX;
  touchStartY = t.clientY;
}, { passive: true });

// Register grid input
document.addEventListener("touchend", e => {
  if (inputCode.length >= MAX_INPUTS) return;

  const width = window.innerWidth;
  const height = window.innerHeight;
  const gridNum = getGridNumber(touchStartX, touchStartY, width, height);

  if (gridNum >= 1 && gridNum <= 9) {
    inputCode += gridNum;
    if (inputCode.length === MAX_INPUTS) sendCode();
  }
}, { passive: true });
</script>

</body>
</html>
